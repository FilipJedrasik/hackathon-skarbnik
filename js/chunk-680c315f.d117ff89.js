(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-680c315f"],{"0db6":function(e,t,n){"use strict";var s=n("4c5e"),i=n.n(s);i.a},2909:function(e,t,n){"use strict";function s(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}function i(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function r(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function a(e){return s(e)||i(e)||r()}n.d(t,"a",function(){return a})},4657:function(e,t,n){"use strict";n.r(t);var s=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-flex",{attrs:{xs12:""}},[n("util-modal",{attrs:{type:e.response.type,content:null!==e.response.content?e.response.content:void 0,header:null!==e.response.header?e.response.header:void 0,ok:null!==e.response.ok?e.response.ok:void 0,cancel:null!==e.response.cancel?e.response.cancel:void 0,okDisabled:e.processing},on:{ok:e.asDeleteStudent,cancel:function(t){e.response.modal=!1}},model:{value:e.response.modal,callback:function(t){e.$set(e.response,"modal",t)},expression:"response.modal"}}),n("v-toolbar",{attrs:{flat:"",color:"white"}},[n("v-toolbar-title",[e._v("Uczniowie")]),n("v-spacer"),n("br"),n("v-btn",{directives:[{name:"show",rawName:"v-show",value:e.students.length,expression:"students.length"}],staticClass:"mb-2",attrs:{color:"primary",disabled:e.loading,dark:!e.loading},on:{click:e.showAddModal}},[e._v(e._s(e.$vuetify.breakpoint.xsOnly?"+":"Dodaj ucznia"))]),n("v-dialog",{attrs:{"max-width":"600px"},model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[n("v-card",[n("v-card-title",[n("span",{staticClass:"headline"},[e._v(e._s(e.formTitle))])]),n("v-form",{ref:"studentform",attrs:{"lazy-validation":""},on:{submit:function(t){-1===e.editedIndex?e.add():e.edit()}},model:{value:e.valid,callback:function(t){e.valid=t},expression:"valid"}},[n("v-card-text",[n("v-container",{attrs:{"grid-list-md":""}},[n("v-flex",{attrs:{xs12:""}},[n("v-text-field",{attrs:{"prepend-icon":"assignment_ind",rules:e.nameRules,label:"Imię i nazwisko",required:""},nativeOn:{keyup:[function(t){if(!("button"in t)&&e._k(t.keyCode,"esc",27,t.key,"Escape"))return null;e.dialog=!1},function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key,"Enter"))return null;(e.valid||JSON.stringify(e.student)!==JSON.stringify(e.beforeEdit))&&(-1===e.editedIndex?e.add():e.edit())}]},model:{value:e.student.name,callback:function(t){e.$set(e.student,"name",t)},expression:"student.name"}})],1),n("v-flex",{attrs:{xs12:""}},[n("v-select",{attrs:{items:e.parents,"item-text":"name","item-value":"id_field","menu-props":"auto",label:"Rodzic",rules:e.notEmptyRules,"prepend-icon":"contacts","single-line":"",required:""},model:{value:e.student.user.id_field,callback:function(t){e.$set(e.student.user,"id_field",t)},expression:"student.user.id_field"}})],1),n("v-flex",{attrs:{xs12:""}},[n("v-select",{attrs:{items:e.classes,"item-text":"name","item-value":"id_field","menu-props":"auto",label:"Klasa",rules:e.notEmptyRules,"prepend-icon":"event_note","single-line":"",required:""},model:{value:e.student.class_field.id_field,callback:function(t){e.$set(e.student.class_field,"id_field",t)},expression:"student.class_field.id_field"}})],1)],1),n("div",{staticStyle:{"text-align":"right"}},[n("v-btn",{attrs:{color:"secondary"},nativeOn:{click:function(t){e.dialog=!1}}},[e._v("Anuluj")]),n("v-btn",{attrs:{color:"primary",disabled:!e.valid||JSON.stringify(e.student)===JSON.stringify(e.beforeEdit)},nativeOn:{click:function(t){-1===e.editedIndex?e.add():e.edit()}}},[e._v(e._s(e.submitTitle))])],1)],1)],1)],1)],1)],1),n("v-data-table",{staticClass:"elevation-1",attrs:{headers:e.headers,items:e.loading?[]:e.students,loading:e.loading,"item-key":"name"},scopedSlots:e._u([{key:"items",fn:function(t){return[n("td",[e._v(e._s(t.item.name))]),e.$vuetify.breakpoint.xsOnly?e._e():[n("td",[e._v(e._s(t.item.user.name))]),n("td",[e._v(e._s(t.item.class_field.name))])],n("td",{staticClass:"justify-center layout px-0"},[n("v-icon",{staticClass:"mr-2",attrs:{color:"blue"},on:{click:function(n){e.editItem(t.item,t.index)}}},[e._v("\n                    edit\n                ")]),n("v-icon",{attrs:{color:"red"},on:{click:function(n){e.deleteItem(t.item)}}},[e._v("\n                    delete\n                ")])],1)]}}])},[e.loading?n("v-progress-linear",{attrs:{slot:"progress",color:"blue",indeterminate:""},slot:"progress"}):e._e(),n("template",{slot:"no-data"},[n("div",{staticStyle:{"text-align":"center",padding:"15px 0"}},[e.loading?n("v-progress-circular",{attrs:{size:70,color:"primary",indeterminate:""}}):n("v-btn",{attrs:{color:"primary"},on:{click:function(t){e.dialog=!0}}},[e._v("Dodaj ucznia")])],1)])],2)],1)},i=[],r=(n("7514"),n("7f7f"),n("20d6"),n("96cf"),n("1da1")),a=n("2909"),o=(n("f751"),n("e8dc")),d={name:"",class_field:{id:null,name:""},user:{id_field:null,name:""}},l={data:function(){return{loadedFullData:!1,loading:!1,dialog:!1,valid:!1,beforeEdit:{},response:{type:"error",modal:!1,content:null,ok:null,cancel:null},student:Object.assign({},d),deletingStudent:{student:{},index:null},editedIndex:-1}},computed:{formTitle:function(){return-1===this.editedIndex?"Dodawanie ucznia":"Edytowanie ucznia"},submitTitle:function(){return-1===this.editedIndex?"Dodaj":"Zapisz"},students:function(){return this.$store.getters["students/getStudents"]},parents:function(){return this.$store.getters["parents/getParents"]},classes:function(){return this.$store.getters["classes/getClasses"]},loginUsed:function(){var e=this;return Object(a["a"])(this.loginRules).concat([function(t){return null!=t&&Array.isArray(e.students)&&0==e.students.filter(function(n){return-1!=e.editedIndex?e.beforeEdit.username!==n.username&&n.username==t.trim():n.username==t.trim()}).length||"Podany login jest już zajęty"}])},headers:function(){return this.$vuetify.breakpoint.xsOnly?[{text:"Imię i nazwisko",value:"name"},{text:"Akcje",value:"name",sortable:!1}]:this.$vuetify.breakpoint.mdAndUp?[{text:"Imię i nazwisko",value:"name"},{text:"Rodzic",value:"parent"},{text:"Klasa",value:"theClass"},{text:"Akcje",value:"name",sortable:!1}]:[{text:"Imię i nazwisko",value:"name"},{text:"Email",value:"email"},{text:"Login",value:"login"},{text:"Akcje",value:"name",sortable:!1}]}},methods:{add:function(){var e=Object(r["a"])(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(this.$refs.studentform.validate()){this.response.ok=null,this.response.cancel=null;try{this.asyncProcess(!0),this.fillNames(),this.$store.dispatch("students/addStudent",this.student),this.dialog=!1,this.student=JSON.parse(JSON.stringify(d)),this.asyncProcess(!1),this.response.content="Udało się dodać ucznia",this.response.type="success",this.response.modal=!0}catch(t){this.asyncProcess(!1),this.response.content=t,this.response.type="error",this.response.modal=!0}}case 1:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),edit:function(){var e=Object(r["a"])(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(this.$refs.studentform.validate()){this.response.ok=null,this.response.cancel=null;try{this.asyncProcess(!0),this.fillNames(),this.$store.dispatch("students/updateStudent",{student:this.student,id:this.student.id_field}),this.dialog=!1,this.student=Object.assign({},d),this.asyncProcess(!1),this.response.content="Udało się zaaktualizować studenta",this.response.type="success",this.response.modal=!0}catch(t){this.asyncProcess(!1),this.response.content=t,this.response.type="error",this.response.modal=!0}}case 1:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),editItem:function(){var e=Object(r["a"])(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return this.editedIndex=this.students.findIndex(function(e){return e.id_field===t.id_field}),this.beforeEdit=JSON.parse(JSON.stringify(t)),this.student=JSON.parse(JSON.stringify(t)),e.next=5,this.parentsAndTeachers();case 5:this.dialog=!0;case 6:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),deleteItem:function(e){this.response.header="Uwaga",this.response.content="Czy na pewno chcesz usunąć konto ".concat(e.name,"?"),this.response.ok="Tak",this.response.cancel="Anuluj",this.response.type="error",this.response.modal=!0,this.deletingStudent.student=e,this.deletingStudent.index=this.students.findIndex(function(t){return t.id_field===e.id_field})},asDeleteStudent:function(){var e=Object(r["a"])(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,this.asyncProcess(!0),e.next=4,this.$store.dispatch("students/deleteStudent",this.deletingStudent.student.id_field);case 4:this.response.modal=!1,this.deletingStudent={student:{},index:null},this.asyncProcess(!1),e.next=17;break;case 9:e.prev=9,e.t0=e["catch"](0),this.asyncProcess(!1),this.response.content=e.t0,this.response.type="error",this.response.modal=!0,this.response.ok=null,this.response.cancel=null;case 17:case"end":return e.stop()}},e,this,[[0,9]])}));return function(){return e.apply(this,arguments)}}(),showAddModal:function(){var e=Object(r["a"])(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return this.editedIndex=-1,this.student=JSON.parse(JSON.stringify(d)),this.beforeEdit=JSON.parse(JSON.stringify(this.student)),this.$refs.studentform.resetValidation(),e.next=6,this.parentsAndTeachers();case 6:this.dialog=!0;case 7:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),parentsAndTeachers:function(){var e=Object(r["a"])(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(this.loadedFullData){e.next=8;break}return this.asyncProcess(!0),e.next=4,this.$store.dispatch("parents/getParents");case 4:return e.next=6,this.$store.dispatch("classes/getClasses");case 6:this.loadedFullData=!0,this.asyncProcess(!1);case 8:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),fillNames:function(){var e=this;this.student.user.name=this.parents.find(function(t){return t.id_field===e.student.user.id_field}).name,this.student.class_field.name=this.classes.find(function(t){return t.id_field===e.student.class_field.id_field}).name}},components:{UtilModal:o["a"]},created:function(){var e=Object(r["a"])(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return this.loading=!0,e.next=3,this.$store.dispatch("students/getStudents");case 3:this.loading=!1;case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},u=l,c=(n("0db6"),n("2877")),p=n("6544"),f=n.n(p),h=n("8336"),m=n("b0af"),v=n("99d9"),g=n("12b2"),y=n("a523"),b=n("8fea"),x=n("169a"),k=n("0e8f"),_=n("4bd4"),w=n("132d"),S=n("490a"),O=n("8e36"),j=n("b56d"),A=n("9910"),I=n("2677"),$=n("71d9"),z=n("2a7f"),R=Object(c["a"])(u,s,i,!1,null,"6a63279b",null);R.options.__file="StudentsAdminView.vue";t["default"]=R.exports;f()(R,{VBtn:h["a"],VCard:m["a"],VCardText:v["a"],VCardTitle:g["a"],VContainer:y["a"],VDataTable:b["a"],VDialog:x["a"],VFlex:k["a"],VForm:_["a"],VIcon:w["a"],VProgressCircular:S["a"],VProgressLinear:O["a"],VSelect:j["a"],VSpacer:A["a"],VTextField:I["a"],VToolbar:$["a"],VToolbarTitle:z["b"]})},"4c5e":function(e,t,n){},7514:function(e,t,n){"use strict";var s=n("5ca1"),i=n("0a49")(5),r="find",a=!0;r in[]&&Array(1)[r](function(){a=!1}),s(s.P+s.F*a,"Array",{find:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}}),n("9c6c")(r)}}]);
//# sourceMappingURL=chunk-680c315f.d117ff89.js.map